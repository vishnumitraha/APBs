FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktbGVtcDctbXlzcWwKZGVzY3JpcHRpb246IEJpdG5h\
bWkgTEVNUDcgd2l0aCBNeVNRTCBBbnNpYmxlIFBsYXlib29rIEJ1bmRsZQpiaW5kYWJsZTogRmFs\
c2UKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBCaXRuYW1pIExFTVA3\
IHdpdGggTXlTUUwgKEFQQikKICBkZXBlbmRlbmNpZXM6CiAgICAtICdkb2NrZXIuaW8vYWxlc3Nm\
Zy9vcGVuc2hpZnQtbmdpbngnCiAgICAtICdkb2NrZXIuaW8vamF2c2FsZ2FyL3BocC1mcG0tcmVk\
aGF0OjcuMicKICAgIC0gJ3JlZ2lzdHJ5LmFjY2Vzcy5yZWRoYXQuY29tL3Joc2NsL215c3FsLTU3\
LXJoZWw3JwogIGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vZG9jcy5iaXRuYW1pLmNvbS9pbnN0\
YWxsZXIvaW5mcmFzdHJ1Y3R1cmUvbmdpbngvCiAgaW1hZ2VVcmw6IGh0dHBzOi8vZDd1bXFpY3Bp\
NzI2My5jbG91ZGZyb250Lm5ldC9pbWcvcHJvZHVjdC85Y2MyNDk1ZC1hYjA2LTQ4ZWEtOGNkZi1l\
MjAzZjhmYjZlZjAvZDdhZGVkOWYtNTViYy00MTYwLThiNzMtNzg1NGMyMTA5NDYxLnBuZwogIHBy\
b3ZpZGVyRGlzcGxheU5hbWU6IEJpdG5hbWkKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBk\
ZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBwaHAtZnBtIDcuMiwgTmdpbngg\
YW5kIE15U1FMCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6\
CiAgICAgIC0gbmFtZTogZ2l0X3JlcG8KICAgICAgICBkZWZhdWx0OiBodHRwczovL2dpdGh1Yi5j\
b20vY2Fycm9kaGVyL3NhbXBsZS1QSFAtYXBwCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAg\
dGl0bGU6IEdpdCBSZXBvc2l0b3J5CiAgICAgICAgZGVzY3JpcHRpb246IEdpdCByZXBvc2l0b3J5\
IGNvbnRhaW5pbmcgUEhQIGFwcGxpY2F0aW9uCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
LSBuYW1lOiBkYl9uYW1lCiAgICAgICAgZGVmYXVsdDogZGF0YWJhc2UKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfXSpbYS16QS1aX10rW2EtekEtWjAt\
OV9dKiQiCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIG5hbWUKICAgICAgICBkZXNjcmlwdGlvbjog\
RGF0YWJhc2UgbmFtZQogICAgICAtIG5hbWU6IGRiX3VzZXIKICAgICAgICBkZWZhdWx0OiBkYnVz\
ZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfXSpb\
YS16QS1aX10rW2EtekEtWjAtOV9dKiQiCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIHVzZXIKICAg\
ICAgICBkZXNjcmlwdGlvbjogRGF0YWJhc2UgdXNlcgogICAgICAtIG5hbWU6IGRiX3Bhc3N3b3Jk\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIHBhc3N3b3JkCiAg\
ICAgICAgZGVzY3JpcHRpb246IERhdGFiYXNlIHBhc3N3b3JkCiAgICAgICAgZGlzcGxheV90eXBl\
OiBwYXNzd29yZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogdm9sdW1lX3Np\
emUKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZGVmYXVsdDogJzFHaScKICAgICAgICBlbnVt\
OiBbJzFHaScsICc1R2knLCAnMTBHaSddCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIHZvbHVtZSBz\
aXplCiAgICAgICAgcmVxdWlyZWQ6IHRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
COPY licenses /licenses
USER apb
