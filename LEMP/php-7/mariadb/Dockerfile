FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktbGVtcApkZXNjcmlwdGlvbjogQml0bmFtaSBMRU1Q\
IEFuc2libGUgUGxheWJvb2sgQnVuZGxlCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwK\
bWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IEJpdG5hbWkgTEVNUCAoQVBCKQogIGRlcGVuZGVuY2ll\
czoKICAgIC0gJ2RvY2tlci5pby9hbGVzc2ZnL29wZW5zaGlmdC1uZ2lueCcKICAgIC0gJ2RvY2tl\
ci5pby9jYXJyb2RoZXIvcGhwLWZwbS1ub24tcm9vdCcKICAgIC0gJ3JlZ2lzdHJ5LmFjY2Vzcy5y\
ZWRoYXQuY29tL3Joc2NsL21hcmlhZGItMTAxLXJoZWw3JwogIGRvY3VtZW50YXRpb25Vcmw6IGh0\
dHBzOi8vZG9jcy5iaXRuYW1pLmNvbS9pbnN0YWxsZXIvaW5mcmFzdHJ1Y3R1cmUvbmdpbngvCiAg\
aW1hZ2VVcmw6IGh0dHBzOi8vZDd1bXFpY3BpNzI2My5jbG91ZGZyb250Lm5ldC9pbWcvcHJvZHVj\
dC85Y2MyNDk1ZC1hYjA2LTQ4ZWEtOGNkZi1lMjAzZjhmYjZlZjAvZDdhZGVkOWYtNTViYy00MTYw\
LThiNzMtNzg1NGMyMTA5NDYxLnBuZwogIHByb3ZpZGVyRGlzcGxheU5hbWU6IEJpdG5hbWkKcGxh\
bnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4g\
ZGVwbG95cyBwaHAtZnBtLCBOZ2lueCBhbmQgTWFyaWFEQgogICAgZnJlZTogVHJ1ZQogICAgbWV0\
YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGdpdF9yZXBvCiAgICAgICAg\
ZGVmYXVsdDogaHR0cHM6Ly9naXRodWIuY29tL2NhcnJvZGhlci9zYW1wbGUtUEhQLWFwcAogICAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBHaXQgUmVwb3NpdG9yeQogICAgICAgIGRl\
c2NyaXB0aW9uOiBHaXQgcmVwb3NpdG9yeSBjb250YWluaW5nIFBIUCBhcHBsaWNhdGlvbgogICAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogZGJfbmFtZQogICAgICAgIGRlZmF1bHQ6\
IGRhdGFiYXNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1a\
MC05X10qW2EtekEtWl9dK1thLXpBLVowLTlfXSokIgogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBu\
YW1lCiAgICAgICAgZGVzY3JpcHRpb246IERhdGFiYXNlIG5hbWUKICAgICAgLSBuYW1lOiBkYl91\
c2VyCiAgICAgICAgZGVmYXVsdDogZGJ1c2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAg\
cGF0dGVybjogIl5bYS16QS1aMC05X10qW2EtekEtWl9dK1thLXpBLVowLTlfXSokIgogICAgICAg\
IHRpdGxlOiBEYXRhYmFzZSB1c2VyCiAgICAgICAgZGVzY3JpcHRpb246IERhdGFiYXNlIHVzZXIK\
ICAgICAgLSBuYW1lOiBkYl9wYXNzd29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRp\
dGxlOiBEYXRhYmFzZSBwYXNzd29yZAogICAgICAgIGRlc2NyaXB0aW9uOiBEYXRhYmFzZSBwYXNz\
d29yZAogICAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgICByZXF1aXJlZDogdHJ1\
ZQogICAgICAtIG5hbWU6IHZvbHVtZV9zaXplCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGRl\
ZmF1bHQ6ICcxR2knCiAgICAgICAgZW51bTogWycxR2knLCAnNUdpJywgJzEwR2knXQogICAgICAg\
IHRpdGxlOiBEYXRhYmFzZSB2b2x1bWUgc2l6ZQogICAgICAgIHJlcXVpcmVkOiB0cnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
