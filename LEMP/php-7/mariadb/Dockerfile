FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktbGVtcDctbWFyaWFkYgpkZXNjcmlwdGlvbjogQml0\
bmFtaSBMRU1QNyB3aXRoIE1hcmlhREIgQW5zaWJsZSBQbGF5Ym9vayBCdW5kbGUKYmluZGFibGU6\
IEZhbHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQml0bmFtaSBM\
RU1QNyB3aXRoIE1hcmlhREIgKEFQQikKICBkZXBlbmRlbmNpZXM6CiAgICAtICdkb2NrZXIuaW8v\
YWxlc3NmZy9vcGVuc2hpZnQtbmdpbngnCiAgICAtICdkb2NrZXIuaW8vY2Fycm9kaGVyL3BocC1m\
cG0tbm9uLXJvb3QtNy4yJwogICAgLSAncmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wv\
bWFyaWFkYi0xMDEtcmhlbDcnCiAgZG9jdW1lbnRhdGlvblVybDogaHR0cHM6Ly9kb2NzLmJpdG5h\
bWkuY29tL2luc3RhbGxlci9pbmZyYXN0cnVjdHVyZS9uZ2lueC8KICBpbWFnZVVybDogaHR0cHM6\
Ly9kN3VtcWljcGk3MjYzLmNsb3VkZnJvbnQubmV0L2ltZy9wcm9kdWN0LzljYzI0OTVkLWFiMDYt\
NDhlYS04Y2RmLWUyMDNmOGZiNmVmMC9kN2FkZWQ5Zi01NWJjLTQxNjAtOGI3My03ODU0YzIxMDk0\
NjEucG5nCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogQml0bmFtaQpwbGFuczoKICAtIG5hbWU6IGRl\
ZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBsb3lzIHBocC1mcG0g\
Ny4yLCBOZ2lueCBhbmQgTWFyaWFEQgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAg\
ICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGdpdF9yZXBvCiAgICAgICAgZGVmYXVsdDogaHR0\
cHM6Ly9naXRodWIuY29tL2NhcnJvZGhlci9zYW1wbGUtUEhQLWFwcAogICAgICAgIHR5cGU6IHN0\
cmluZwogICAgICAgIHRpdGxlOiBHaXQgUmVwb3NpdG9yeQogICAgICAgIGRlc2NyaXB0aW9uOiBH\
aXQgcmVwb3NpdG9yeSBjb250YWluaW5nIFBIUCBhcHBsaWNhdGlvbgogICAgICAgIHJlcXVpcmVk\
OiB0cnVlCiAgICAgIC0gbmFtZTogZGJfbmFtZQogICAgICAgIGRlZmF1bHQ6IGRhdGFiYXNlCiAg\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10qW2EtekEt\
Wl9dK1thLXpBLVowLTlfXSokIgogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBuYW1lCiAgICAgICAg\
ZGVzY3JpcHRpb246IERhdGFiYXNlIG5hbWUKICAgICAgLSBuYW1lOiBkYl91c2VyCiAgICAgICAg\
ZGVmYXVsdDogZGJ1c2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcGF0dGVybjogIl5b\
YS16QS1aMC05X10qW2EtekEtWl9dK1thLXpBLVowLTlfXSokIgogICAgICAgIHRpdGxlOiBEYXRh\
YmFzZSB1c2VyCiAgICAgICAgZGVzY3JpcHRpb246IERhdGFiYXNlIHVzZXIKICAgICAgLSBuYW1l\
OiBkYl9wYXNzd29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBEYXRhYmFz\
ZSBwYXNzd29yZAogICAgICAgIGRlc2NyaXB0aW9uOiBEYXRhYmFzZSBwYXNzd29yZAogICAgICAg\
IGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5h\
bWU6IHZvbHVtZV9zaXplCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGRlZmF1bHQ6ICcxR2kn\
CiAgICAgICAgZW51bTogWycxR2knLCAnNUdpJywgJzEwR2knXQogICAgICAgIHRpdGxlOiBEYXRh\
YmFzZSB2b2x1bWUgc2l6ZQogICAgICAgIHJlcXVpcmVkOiB0cnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
