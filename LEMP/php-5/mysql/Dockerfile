FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktbGVtcDUtbXlzcWwKZGVzY3JpcHRpb246IEJpdG5h\
bWkgTEVNUDUgd2l0aCBNeVNRTCBBbnNpYmxlIFBsYXlib29rIEJ1bmRsZQpiaW5kYWJsZTogRmFs\
c2UKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBCaXRuYW1pIExFTVA1\
IHdpdGggTXlTUUwgKEFQQikKICBkZXBlbmRlbmNpZXM6CiAgICAtICdkb2NrZXIuaW8vYWxlc3Nm\
Zy9vcGVuc2hpZnQtbmdpbngnCiAgICAtICdkb2NrZXIuaW8vY2Fycm9kaGVyL3BocC1mcG0tbm9u\
LXJvb3QtNS42JwogICAgLSAncmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wvbXlzcWwt\
NTctcmhlbDcnCiAgZG9jdW1lbnRhdGlvblVybDogaHR0cHM6Ly9kb2NzLmJpdG5hbWkuY29tL2lu\
c3RhbGxlci9pbmZyYXN0cnVjdHVyZS9uZ2lueC8KICBpbWFnZVVybDogaHR0cHM6Ly9kN3VtcWlj\
cGk3MjYzLmNsb3VkZnJvbnQubmV0L2ltZy9wcm9kdWN0LzljYzI0OTVkLWFiMDYtNDhlYS04Y2Rm\
LWUyMDNmOGZiNmVmMC9kN2FkZWQ5Zi01NWJjLTQxNjAtOGI3My03ODU0YzIxMDk0NjEucG5nCiAg\
cHJvdmlkZXJEaXNwbGF5TmFtZTogQml0bmFtaQpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAg\
IGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBkZXBsb3lzIHBocC1mcG0gNS42LCBOZ2lu\
eCBhbmQgTXlTUUwKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVy\
czoKICAgICAgLSBuYW1lOiBnaXRfcmVwbwogICAgICAgIGRlZmF1bHQ6IGh0dHBzOi8vZ2l0aHVi\
LmNvbS9jYXJyb2RoZXIvc2FtcGxlLVBIUC1hcHAKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAg\
ICB0aXRsZTogR2l0IFJlcG9zaXRvcnkKICAgICAgICBkZXNjcmlwdGlvbjogR2l0IHJlcG9zaXRv\
cnkgY29udGFpbmluZyBQSFAgYXBwbGljYXRpb24KICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAg\
ICAtIG5hbWU6IGRiX25hbWUKICAgICAgICBkZWZhdWx0OiBkYXRhYmFzZQogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV9dKlthLXpBLVpfXStbYS16QS1a\
MC05X10qJCIKICAgICAgICB0aXRsZTogRGF0YWJhc2UgbmFtZQogICAgICAgIGRlc2NyaXB0aW9u\
OiBEYXRhYmFzZSBuYW1lCiAgICAgIC0gbmFtZTogZGJfdXNlcgogICAgICAgIGRlZmF1bHQ6IGRi\
dXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV9d\
KlthLXpBLVpfXStbYS16QS1aMC05X10qJCIKICAgICAgICB0aXRsZTogRGF0YWJhc2UgdXNlcgog\
ICAgICAgIGRlc2NyaXB0aW9uOiBEYXRhYmFzZSB1c2VyCiAgICAgIC0gbmFtZTogZGJfcGFzc3dv\
cmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogRGF0YWJhc2UgcGFzc3dvcmQK\
ICAgICAgICBkZXNjcmlwdGlvbjogRGF0YWJhc2UgcGFzc3dvcmQKICAgICAgICBkaXNwbGF5X3R5\
cGU6IHBhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiB2b2x1bWVf\
c2l6ZQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBkZWZhdWx0OiAnMUdpJwogICAgICAgIGVu\
dW06IFsnMUdpJywgJzVHaScsICcxMEdpJ10KICAgICAgICB0aXRsZTogRGF0YWJhc2Ugdm9sdW1l\
IHNpemUKICAgICAgICByZXF1aXJlZDogdHJ1ZQo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
