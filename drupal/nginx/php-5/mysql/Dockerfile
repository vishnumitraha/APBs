FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktZHJ1cGFsLW5naW54LXBocDUtbXlzcWwKZGVzY3Jp\
cHRpb246IEJpdG5hbWkgRHJ1cGFsIHdpdGggTmdpbngsIFBIUDUgYW5kIE15U1FMIEFuc2libGUg\
UGxheWJvb2sgQnVuZGxlCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6\
CiAgZGlzcGxheU5hbWU6IEJpdG5hbWkgRHJ1cGFsIHdpdGggTmdpbngsIFBIUDUgYW5kIE15U1FM\
IChBUEIpCiAgZGVwZW5kZW5jaWVzOgogICAgLSAncmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20v\
cmhzY2wvbXlzcWwtNTctcmhlbDcnCiAgICAtICdkb2NrZXIuaW8vamF2c2FsZ2FyL2JpdG5hbWkt\
ZHJ1cGFsLXJoZWwtbmdpbngtcGhwNScKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL2RvY3Mu\
Yml0bmFtaS5jb20vaW5zdGFsbGVyL2FwcHMvZHJ1cGFsLwogIGltYWdlVXJsOiBodHRwczovL2Qz\
M25wOW4zMmo1M2c3LmNsb3VkZnJvbnQubmV0L2Fzc2V0cy9zdGFja3MvZHJ1cGFsL2ltZy9kcnVw\
YWwtc3RhY2stMTEweDExNy05ZjkzOTExZGEyZjI2MmVjMGEyZTVkNDljZGJkNTU2Zi5wbmcKICBw\
cm92aWRlckRpc3BsYXlOYW1lOiBCaXRuYW1pCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAg\
ZGVzY3JpcHRpb246IFRoaXMgZGVmYXVsdCBwbGFuIGRlcGxveXMgRHJ1cGFsIHdpdGggcGhwLWZw\
bSA3LjIsIE5naW54IGFuZCBNYXJpYURCCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30K\
ICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogZHJ1cGFsX2VtYWlsCiAgICAgICAgZGVmYXVs\
dDogdXNlckBleGFtcGxlLmNvbQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBV\
c2VyIGVtYWlsCiAgICAgICAgZGVzY3JpcHRpb246IFVzZXIgZW1haWwKICAgICAgLSBuYW1lOiBk\
cnVwYWxfdXNlcm5hbWUKICAgICAgICBkZWZhdWx0OiB1c2VyCiAgICAgICAgcGF0dGVybjogIl5b\
YS16QS1aMC05X10qW2EtekEtWl9dK1thLXpBLVowLTlfXSokIgogICAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgICAgIHRpdGxlOiBEcnVwYWwgYWRtaW4gdXNlcm5hbWUKICAgICAgICBkZXNjcmlwdGlv\
bjogRHJ1cGFsIGFkbWluIHVzZXJuYW1lCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBu\
YW1lOiBkcnVwYWxfcGFzc3dvcmQKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfXSpbYS16\
QS1aX10rW2EtekEtWjAtOV9dKiQiCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6\
IERydXBhbCBhZG1pbiBwYXNzd29yZAogICAgICAgIGRlc2NyaXB0aW9uOiBEcnVwYWwgYWRtaW4g\
cGFzc3dvcmQKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAgICAgLSBuYW1lOiBkYl9uYW1lCiAgICAgICAgZGVmYXVsdDogZGF0YWJhc2UKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfXSpbYS16QS1a\
X10rW2EtekEtWjAtOV9dKiQiCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIG5hbWUKICAgICAgICBk\
ZXNjcmlwdGlvbjogRGF0YWJhc2UgbmFtZQogICAgICAtIG5hbWU6IGRiX3VzZXIKICAgICAgICBk\
ZWZhdWx0OiBkYnVzZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBwYXR0ZXJuOiAiXlth\
LXpBLVowLTlfXSpbYS16QS1aX10rW2EtekEtWjAtOV9dKiQiCiAgICAgICAgdGl0bGU6IERhdGFi\
YXNlIHVzZXIKICAgICAgICBkZXNjcmlwdGlvbjogRGF0YWJhc2UgdXNlcgogICAgICAtIG5hbWU6\
IGRiX3Bhc3N3b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IERhdGFiYXNl\
IHBhc3N3b3JkCiAgICAgICAgZGVzY3JpcHRpb246IERhdGFiYXNlIHBhc3N3b3JkCiAgICAgICAg\
ZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFt\
ZTogdm9sdW1lX3NpemUKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZGVmYXVsdDogJzFHaScK\
ICAgICAgICBlbnVtOiBbJzFHaScsICc1R2knLCAnMTBHaSddCiAgICAgICAgdGl0bGU6IERhdGFi\
YXNlIHZvbHVtZSBzaXplCiAgICAgICAgcmVxdWlyZWQ6IHRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
COPY licenses /licenses
USER apb
