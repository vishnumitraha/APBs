FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktZHJ1cGFsLW5naW54LXBocDctbXlzcWwKZGVzY3Jp\
cHRpb246IEJpdG5hbWkgRHJ1cGFsIHdpdGggTmdpbngsIFBIUDcgYW5kIE15U1FMIEFuc2libGUg\
UGxheWJvb2sgQnVuZGxlCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6\
CiAgZGlzcGxheU5hbWU6IEJpdG5hbWkgRHJ1cGFsIHdpdGggTmdpbngsIFBIUDcgYW5kIE1hcmlh\
REIgKEFQQikKICBkZXBlbmRlbmNpZXM6CiAgICAtICdyZWdpc3RyeS5hY2Nlc3MucmVkaGF0LmNv\
bS9yaHNjbC9teXNxbC01Ny1yaGVsNycKICAgIC0gJ2RvY2tlci5pby9qYXZzYWxnYXIvYml0bmFt\
aS1kcnVwYWwtcmhlbC1uZ2lueC1waHA3JwogIGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vZG9j\
cy5iaXRuYW1pLmNvbS9pbnN0YWxsZXIvYXBwcy9kcnVwYWwvCiAgaW1hZ2VVcmw6IGh0dHBzOi8v\
ZDMzbnA5bjMyajUzZzcuY2xvdWRmcm9udC5uZXQvYXNzZXRzL3N0YWNrcy9kcnVwYWwvaW1nL2Ry\
dXBhbC1zdGFjay0xMTB4MTE3LTlmOTM5MTFkYTJmMjYyZWMwYTJlNWQ0OWNkYmQ1NTZmLnBuZwog\
IHByb3ZpZGVyRGlzcGxheU5hbWU6IEJpdG5hbWkKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAg\
ICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBEcnVwYWwgd2l0aCBwaHAt\
ZnBtIDcuMiwgTmdpbnggYW5kIE1hcmlhREIKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7\
fQogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBkcnVwYWxfZW1haWwKICAgICAgICBkZWZh\
dWx0OiB1c2VyQGV4YW1wbGUuY29tCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6\
IFVzZXIgZW1haWwKICAgICAgICBkZXNjcmlwdGlvbjogVXNlciBlbWFpbAogICAgICAtIG5hbWU6\
IGRydXBhbF91c2VybmFtZQogICAgICAgIGRlZmF1bHQ6IHVzZXIKICAgICAgICBwYXR0ZXJuOiAi\
XlthLXpBLVowLTlfXSpbYS16QS1aX10rW2EtekEtWjAtOV9dKiQiCiAgICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgICAgdGl0bGU6IERydXBhbCBhZG1pbiB1c2VybmFtZQogICAgICAgIGRlc2NyaXB0\
aW9uOiBEcnVwYWwgYWRtaW4gdXNlcm5hbWUKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAt\
IG5hbWU6IGRydXBhbF9wYXNzd29yZAogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV9dKlth\
LXpBLVpfXStbYS16QS1aMC05X10qJCIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRs\
ZTogRHJ1cGFsIGFkbWluIHBhc3N3b3JkCiAgICAgICAgZGVzY3JpcHRpb246IERydXBhbCBhZG1p\
biBwYXNzd29yZAogICAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgICByZXF1aXJl\
ZDogdHJ1ZQogICAgICAtIG5hbWU6IGRiX25hbWUKICAgICAgICBkZWZhdWx0OiBkYXRhYmFzZQog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV9dKlthLXpB\
LVpfXStbYS16QS1aMC05X10qJCIKICAgICAgICB0aXRsZTogRGF0YWJhc2UgbmFtZQogICAgICAg\
IGRlc2NyaXB0aW9uOiBEYXRhYmFzZSBuYW1lCiAgICAgIC0gbmFtZTogZGJfdXNlcgogICAgICAg\
IGRlZmF1bHQ6IGRidXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHBhdHRlcm46ICJe\
W2EtekEtWjAtOV9dKlthLXpBLVpfXStbYS16QS1aMC05X10qJCIKICAgICAgICB0aXRsZTogRGF0\
YWJhc2UgdXNlcgogICAgICAgIGRlc2NyaXB0aW9uOiBEYXRhYmFzZSB1c2VyCiAgICAgIC0gbmFt\
ZTogZGJfcGFzc3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogRGF0YWJh\
c2UgcGFzc3dvcmQKICAgICAgICBkZXNjcmlwdGlvbjogRGF0YWJhc2UgcGFzc3dvcmQKICAgICAg\
ICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBu\
YW1lOiB2b2x1bWVfc2l6ZQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBkZWZhdWx0OiAnMUdp\
JwogICAgICAgIGVudW06IFsnMUdpJywgJzVHaScsICcxMEdpJ10KICAgICAgICB0aXRsZTogRGF0\
YWJhc2Ugdm9sdW1lIHNpemUKICAgICAgICByZXF1aXJlZDogdHJ1ZQo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
COPY licenses /licenses
USER apb
