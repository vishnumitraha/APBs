FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktbGFtcApkZXNjcmlwdGlvbjogQml0bmFtaSBMQU1Q\
IEFuc2libGUgUGxheWJvb2sgQnVuZGxlCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwK\
bWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IEJpdG5hbWkgTEFNUCAoQVBCKQogIGRlcGVuZGVuY2ll\
czoKICAgIC0gJ3JlZ2lzdHJ5LmFjY2Vzcy5yZWRoYXQuY29tL3Joc2NsL2h0dHBkLTI0LXJoZWw3\
JwogICAgLSAncmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wvbWFyaWFkYi0xMDEtcmhl\
bDcnCiAgICAtICdkb2NrZXIuaW8vY2Fycm9kaGVyL3BocC1mcG0tbm9uLXJvb3QnCiAgZG9jdW1l\
bnRhdGlvblVybDogaHR0cHM6Ly9kb2NzLmJpdG5hbWkuY29tL2luc3RhbGxlci9pbmZyYXN0cnVj\
dHVyZS9sYW1wLwogIGltYWdlVXJsOiBodHRwczovL2Q3dW1xaWNwaTcyNjMuY2xvdWRmcm9udC5u\
ZXQvaW1nL3Byb2R1Y3QvOTYzZTA4YTAtMWU1Zi00MGIzLTlhMWQtNzJhZTMyMmRhMmFjL2M2NTIw\
Njk3LTI4NTItNDA5NC1hOWExLTgyOTM5YzM1MzcwNC5wbmcKICBwcm92aWRlckRpc3BsYXlOYW1l\
OiBCaXRuYW1pCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMg\
ZGVmYXVsdCBwbGFuIGRlcGxveXMgcGhwLWZwbSwgQXBhY2hlIGFuZCBNYXJpYURCCiAgICBmcmVl\
OiBUcnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogZ2l0\
X3JlcG8KICAgICAgICBkZWZhdWx0OiBodHRwczovL2dpdGh1Yi5jb20vY2Fycm9kaGVyL3NhbXBs\
ZS1QSFAtYXBwCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IEdpdCBSZXBvc2l0\
b3J5CiAgICAgICAgZGVzY3JpcHRpb246IEdpdCByZXBvc2l0b3J5IGNvbnRhaW5pbmcgUEhQIGFw\
cGxpY2F0aW9uCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBkYl9uYW1lCiAg\
ICAgICAgZGVmYXVsdDogZGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBwYXR0\
ZXJuOiAiXlthLXpBLVowLTlfXSpbYS16QS1aX10rW2EtekEtWjAtOV9dKiQiCiAgICAgICAgdGl0\
bGU6IERhdGFiYXNlIG5hbWUKICAgICAgICBkZXNjcmlwdGlvbjogRGF0YWJhc2UgbmFtZQogICAg\
ICAtIG5hbWU6IGRiX3VzZXIKICAgICAgICBkZWZhdWx0OiBkYnVzZXIKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVowLTlfXSpbYS16QS1aX10rW2EtekEtWjAt\
OV9dKiQiCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIHVzZXIKICAgICAgICBkZXNjcmlwdGlvbjog\
RGF0YWJhc2UgdXNlcgogICAgICAtIG5hbWU6IGRiX3Bhc3N3b3JkCiAgICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIHBhc3N3b3JkCiAgICAgICAgZGVzY3JpcHRpb246\
IERhdGFiYXNlIHBhc3N3b3JkCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAg\
IHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogdm9sdW1lX3NpemUKICAgICAgICB0eXBlOiBl\
bnVtCiAgICAgICAgZGVmYXVsdDogJzFHaScKICAgICAgICBlbnVtOiBbJzFHaScsICc1R2knLCAn\
MTBHaSddCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIHZvbHVtZSBzaXplCiAgICAgICAgcmVxdWly\
ZWQ6IHRydWUK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
