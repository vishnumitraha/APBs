FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktd29yZHByZXNzLW5naW54LXBocDUtbXlzcWwKZGVz\
Y3JpcHRpb246IEJpdG5hbWkgV29yZFByZXNzIHdpdGggTmdpbngsIFBIUDUgYW5kIE15U1FMIEFu\
c2libGUgUGxheWJvb2sgQnVuZGxlCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKbWV0\
YWRhdGE6CiAgZGlzcGxheU5hbWU6IEJpdG5hbWkgV29yZFByZXNzIHdpdGggTmdpbngsIFBIUDUg\
YW5kIE15U1FMIChBUEIpCiAgZGVwZW5kZW5jaWVzOgogICAgLSAncmVnaXN0cnkuYWNjZXNzLnJl\
ZGhhdC5jb20vcmhzY2wvbXlzcWwtNTctcmhlbDcnCiAgICAtICdkb2NrZXIuaW8vamF2c2FsZ2Fy\
L2JpdG5hbWktd29yZHByZXNzLXJoZWwtbmdpbngtcGhwNScKICBkb2N1bWVudGF0aW9uVXJsOiBo\
dHRwczovL2RvY3MuYml0bmFtaS5jb20vaW5zdGFsbGVyL2FwcHMvd29yZHByZXNzLwogIGltYWdl\
VXJsOiBodHRwczovL2Q3dW1xaWNwaTcyNjMuY2xvdWRmcm9udC5uZXQvaW1nL3Byb2R1Y3QvN2Q0\
MjZjYjctOTUyMi00ZGQ3LWE1NmItNTVkZDhjYzFjOGQwL2I3M2I5ZjA1LTBhOTYtNGNiMS05MTM2\
LTkzZTVlNzYzNjRmYi5wbmcKICBwcm92aWRlckRpc3BsYXlOYW1lOiBCaXRuYW1pCnBsYW5zOgog\
IC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgZGVmYXVsdCBwbGFuIGRlcGxv\
eXMgV29yZFByZXNzIHdpdGggcGhwLWZwbSA3LjIsIE5naW54IGFuZCBNYXJpYURCCiAgICBmcmVl\
OiBUcnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogYmxv\
Z19uYW1lCiAgICAgICAgZGVmYXVsdDogIk15IGJsb2ciCiAgICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgICAgdGl0bGU6IEJsb2cgVGl0bGUKICAgICAgICBkZXNjcmlwdGlvbjogVGl0bGUgb2YgeW91\
ciBibG9nCiAgICAgIC0gbmFtZTogd29yZHByZXNzX3VzZXJuYW1lCiAgICAgICAgZGVmYXVsdDog\
dXNlcgogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV9dKlthLXpBLVpfXStbYS16QS1aMC05\
X10qJCIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogV29yZFByZXNzIGFkbWlu\
IHVzZXJuYW1lCiAgICAgICAgZGVzY3JpcHRpb246IFdvcmRQcmVzcyBhZG1pbiB1c2VybmFtZQog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogd29yZHByZXNzX3Bhc3N3b3JkCiAg\
ICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10qW2EtekEtWl9dK1thLXpBLVowLTlfXSokIgog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBXb3JkUHJlc3MgYWRtaW4gcGFzc3dv\
cmQKICAgICAgICBkZXNjcmlwdGlvbjogV29yZFByZXNzIGFkbWluIHBhc3N3b3JkCiAgICAgICAg\
ZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFt\
ZTogZGJfbmFtZQogICAgICAgIGRlZmF1bHQ6IGRhdGFiYXNlCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10qW2EtekEtWl9dK1thLXpBLVowLTlfXSok\
IgogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBuYW1lCiAgICAgICAgZGVzY3JpcHRpb246IERhdGFi\
YXNlIG5hbWUKICAgICAgLSBuYW1lOiBkYl91c2VyCiAgICAgICAgZGVmYXVsdDogZGJ1c2VyCiAg\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10qW2EtekEt\
Wl9dK1thLXpBLVowLTlfXSokIgogICAgICAgIHRpdGxlOiBEYXRhYmFzZSB1c2VyCiAgICAgICAg\
ZGVzY3JpcHRpb246IERhdGFiYXNlIHVzZXIKICAgICAgLSBuYW1lOiBkYl9wYXNzd29yZAogICAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBwYXNzd29yZAogICAgICAg\
IGRlc2NyaXB0aW9uOiBEYXRhYmFzZSBwYXNzd29yZAogICAgICAgIGRpc3BsYXlfdHlwZTogcGFz\
c3dvcmQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHZvbHVtZV9zaXplCiAg\
ICAgICAgdHlwZTogZW51bQogICAgICAgIGRlZmF1bHQ6ICcxR2knCiAgICAgICAgZW51bTogWycx\
R2knLCAnNUdpJywgJzEwR2knXQogICAgICAgIHRpdGxlOiBEYXRhYmFzZSB2b2x1bWUgc2l6ZQog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
COPY licenses /licenses
USER apb
