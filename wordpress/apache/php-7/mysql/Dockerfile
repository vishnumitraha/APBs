FROM openshift3/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGJpdG5hbWktd29yZHByZXNzLWFwYWNoZS1waHA3LW15c3FsCmRl\
c2NyaXB0aW9uOiBCaXRuYW1pIFdvcmRQcmVzcyB3aXRoIEFwYWNoZSwgUEhQNyBhbmQgTXlTUUwg\
QW5zaWJsZSBQbGF5Ym9vayBCdW5kbGUKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbApt\
ZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQml0bmFtaSBXb3JkUHJlc3Mgd2l0aCBBcGFjaGUsIFBI\
UDcgYW5kIE15U1FMIChBUEIpCiAgZGVwZW5kZW5jaWVzOgogICAgLSAncmVnaXN0cnkuYWNjZXNz\
LnJlZGhhdC5jb20vcmhzY2wvbXlzcWwtNTctcmhlbDcnCiAgICAtICdkb2NrZXIuaW8vamF2c2Fs\
Z2FyL2JpdG5hbWktd29yZHByZXNzLXJoZWwtYXBhY2hlLXBocDcnCiAgZG9jdW1lbnRhdGlvblVy\
bDogaHR0cHM6Ly9kb2NzLmJpdG5hbWkuY29tL2luc3RhbGxlci9hcHBzL3dvcmRwcmVzcy8KICBp\
bWFnZVVybDogaHR0cHM6Ly9kN3VtcWljcGk3MjYzLmNsb3VkZnJvbnQubmV0L2ltZy9wcm9kdWN0\
LzdkNDI2Y2I3LTk1MjItNGRkNy1hNTZiLTU1ZGQ4Y2MxYzhkMC9iNzNiOWYwNS0wYTk2LTRjYjEt\
OTEzNi05M2U1ZTc2MzY0ZmIucG5nCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogQml0bmFtaQpwbGFu\
czoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxhbiBk\
ZXBsb3lzIFdvcmRQcmVzcyB3aXRoIHBocC1mcG0gNy4yLCBBcGFjaGUgYW5kIG15c3FsCiAgICBm\
cmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTog\
YmxvZ19uYW1lCiAgICAgICAgZGVmYXVsdDogIk15IGJsb2ciCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgdGl0bGU6IEJsb2cgVGl0bGUKICAgICAgICBkZXNjcmlwdGlvbjogVGl0bGUgb2Yg\
eW91ciBibG9nCiAgICAgIC0gbmFtZTogd29yZHByZXNzX3VzZXJuYW1lCiAgICAgICAgZGVmYXVs\
dDogdXNlcgogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAtOV9dKlthLXpBLVpfXStbYS16QS1a\
MC05X10qJCIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogV29yZFByZXNzIGFk\
bWluIHVzZXJuYW1lCiAgICAgICAgZGVzY3JpcHRpb246IFdvcmRQcmVzcyBhZG1pbiB1c2VybmFt\
ZQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogd29yZHByZXNzX3Bhc3N3b3Jk\
CiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10qW2EtekEtWl9dK1thLXpBLVowLTlfXSok\
IgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBXb3JkUHJlc3MgYWRtaW4gcGFz\
c3dvcmQKICAgICAgICBkZXNjcmlwdGlvbjogV29yZFByZXNzIGFkbWluIHBhc3N3b3JkCiAgICAg\
ICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0g\
bmFtZTogZGJfbmFtZQogICAgICAgIGRlZmF1bHQ6IGRhdGFiYXNlCiAgICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10qW2EtekEtWl9dK1thLXpBLVowLTlf\
XSokIgogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBuYW1lCiAgICAgICAgZGVzY3JpcHRpb246IERh\
dGFiYXNlIG5hbWUKICAgICAgLSBuYW1lOiBkYl91c2VyCiAgICAgICAgZGVmYXVsdDogZGJ1c2Vy\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05X10qW2Et\
ekEtWl9dK1thLXpBLVowLTlfXSokIgogICAgICAgIHRpdGxlOiBEYXRhYmFzZSB1c2VyCiAgICAg\
ICAgZGVzY3JpcHRpb246IERhdGFiYXNlIHVzZXIKICAgICAgLSBuYW1lOiBkYl9wYXNzd29yZAog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBwYXNzd29yZAogICAg\
ICAgIGRlc2NyaXB0aW9uOiBEYXRhYmFzZSBwYXNzd29yZAogICAgICAgIGRpc3BsYXlfdHlwZTog\
cGFzc3dvcmQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHZvbHVtZV9zaXpl\
CiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGRlZmF1bHQ6ICcxR2knCiAgICAgICAgZW51bTog\
WycxR2knLCAnNUdpJywgJzEwR2knXQogICAgICAgIHRpdGxlOiBEYXRhYmFzZSB2b2x1bWUgc2l6\
ZQogICAgICAgIHJlcXVpcmVkOiB0cnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
COPY licenses /licenses
USER apb
